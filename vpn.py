import telebot
from telebot.types import ReplyKeyboardMarkup, KeyboardButton, InlineKeyboardButton, InlineKeyboardMarkup
from openpyxl import load_workbook
from telebot import types
import openpyxl
from datetime import datetime, timedelta


# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
bot = telebot.TeleBot('5797908031:AAEZGcttLY2rBbm-3jQxGZic8HJ2rANUQMU')

# –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É Excel
excel_file_path = 'TELEGA.xlsx'

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
@bot.message_handler(commands=['start'])
def start(message):
    # –¢–µ–∫—Å—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
    welcome_text = """–ü—Ä–∏–≤–µ—Ç! –í–æ—Ç —á—Ç–æ –º–æ–∂–µ—Ç —ç—Ç–æ—Ç –±–æ—Ç.

–û –Ω–∞—Å: –£–∑–Ω–∞–π—Ç–µ –±–æ–ª—å—à–µ –æ –Ω–∞—à–µ–º —Å–µ—Ä–≤–∏—Å–µ VPN.

–ü–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –ü–æ–ª—É—á–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

–ú–æ–∏ –∑–∞–∫–∞–∑—ã: –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ —Å–≤–æ–∏—Ö –∑–∞–∫–∞–∑–∞—Ö –∏ –ø–æ–¥–ø–∏—Å–∫–∞—Ö.

–ü–æ–¥–¥–µ—Ä–∂–∫–∞: –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ —Å–ª—É–∂–±—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–º–æ—â–∏ –∏ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã.
"""
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ–º –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
    bot.send_message(message.chat.id, welcome_text, reply_markup=create_menu_keyboard())

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã "–ö—É–ø–∏—Ç—å"
@bot.message_handler(func=lambda message: message.text == '–ö–∞–∫ –æ–ø–ª–∞—Ç–∏—Ç—å')
def buy(message):
    # –°–æ–∑–¥–∞–µ–º –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∞—Ä–∏—Ñ–∞–º–∏
    inline_keyboard = InlineKeyboardMarkup()
    # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ —Å —Ç–∞—Ä–∏—Ñ–∞–º–∏
    inline_keyboard.row(
        InlineKeyboardButton("–¢–∞—Ä–∏—Ñ 1 –º–µ—Å—è—Ü", callback_data="tariff_A"),
        InlineKeyboardButton("–¢–∞—Ä–∏—Ñ 3 –º–µ—Å—è—Ü–∞", callback_data="tariff_B")
    )
    inline_keyboard.row(
        InlineKeyboardButton("–¢–∞—Ä–∏—Ñ 6 –º–µ—Å—è—Ü–µ–≤", callback_data="tariff_C"),
        InlineKeyboardButton("–¢–∞—Ä–∏—Ñ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π", callback_data="tariff_D")
    )

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ç–æ –∏ –∫–Ω–æ–ø–∫–∏ —Å —Ç–∞—Ä–∏—Ñ–∞–º–∏
    bot.send_photo(chat_id=message.chat.id, photo=open('photo_2023-10-30_09-13-28.jpg', 'rb'),
                   caption="–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ:", reply_markup=inline_keyboard)


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏ —Ç–∞—Ä–∏—Ñ–æ–≤
@bot.callback_query_handler(func=lambda call: call.data.startswith('tariff_'))
def process_tariff_callback(callback_query):
    tariff_info = {
        "tariff_A": {"title": "–¢–∞—Ä–∏—Ñ 1 –º–µ—Å—è—Ü", "description": "–î–æ—Å—Ç—É–ø –∫ VPN –Ω–∞ 1 –º–µ—Å—è—Ü", "price": 19900},
        "tariff_B": {"title": "–¢–∞—Ä–∏—Ñ 3 –º–µ—Å—è—Ü–∞", "description": "–î–æ—Å—Ç—É–ø –∫ VPN –Ω–∞ 3 –º–µ—Å—è—Ü–∞", "price": 49900},
        "tariff_C": {"title": "–¢–∞—Ä–∏—Ñ 6 –º–µ—Å—è—Ü–µ–≤", "description": "–î–æ—Å—Ç—É–ø –∫ VPN –Ω–∞ 6 –º–µ—Å—è—Ü–µ–≤", "price": 89900},
        "tariff_D": {"title": "–¢–∞—Ä–∏—Ñ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π", "description": "–°—É–ø–µ—Ä —Ç–∞—Ä–∏—Ñ —Å –æ—Å–æ–±—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏", "price": 999999}
    }
    tariff_id = callback_query.data
    selected_tariff = tariff_info[tariff_id]

    if tariff_id == "tariff_D":
        # –°–æ–∑–¥–∞–µ–º –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —Å—ã–ª–∫–æ–π
        inline_keyboard = [[InlineKeyboardButton("–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É", url="https://t.me/ghostguardvpn")]]
        reply_markup = InlineKeyboardMarkup(inline_keyboard)

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –∏ –∏–Ω–ª–∞–π–Ω-—Å—Å—ã–ª–∫—É –≤–º–µ—Å—Ç–µ
        bot.send_message(callback_query.from_user.id,
                         "–î–ª—è –ø–æ–¥–±–æ—Ä–∞ —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–¥ –≤–∞—à–∏ –Ω—É–∂–¥—ã –Ω–∞–ø–∏—à–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤–∞—à–µ–π –∑–∞–¥–∞—á–∏",
                         reply_markup=reply_markup)
    else:
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–Ω–≤–æ–π—Å –¥–ª—è –æ–ø–ª–∞—Ç—ã
        bot.send_invoice(callback_query.from_user.id,
                         title=selected_tariff["title"],
                         description=selected_tariff["description"],
                         provider_token='390540012:LIVE:47653',  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –ø—Ä–æ–≤–∞–π–¥–µ—Ä—Å–∫–∏–π —Ç–æ–∫–µ–Ω
                         currency='RUB',  # –í–∞–ª—é—Ç–∞ (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –¥—Ä—É–≥—É—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—É—é)
                         prices=[telebot.types.LabeledPrice(label='–¶–µ–Ω–∞', amount=selected_tariff["price"])],
                         invoice_payload='payload')


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã
@bot.message_handler(content_types=['successful_payment'])
def successful_payment(message):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–ª–∞—Ç–µ–∂–µ
    payment_info = message.successful_payment

    # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
    user_id = message.chat.id
    username = message.chat.username

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ –æ–ø–ª–∞—Ç–µ
    save_payment_data(user_id, username, payment_info)

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, —Ç–∞—Ä–∏—Ñ–µ –∏ –¥–∞—Ç–µ –æ–ø–ª–∞—Ç—ã
def save_payment_data(user_id, username, tariff):
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ —Ñ–∞–π–ª Excel
    try:
        # –ï—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –µ–≥–æ
        wb = load_workbook(excel_file_path)
        sheet = wb.active
    except FileNotFoundError:
        # –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
        wb = openpyxl.Workbook()
        sheet = wb.active
        sheet['A1'] = 'Username'
        sheet['B1'] = 'User ID'
        sheet['C1'] = '–¢–∞—Ä–∏—Ñ'
        sheet['D1'] = '–î–∞—Ç–∞ –æ–ø–ª–∞—Ç—ã'

    # –ù–∞—Ö–æ–¥–∏–º –ø–µ—Ä–≤—É—é —Å–≤–æ–±–æ–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    next_row = 1
    while sheet[f'B{next_row}'].value:  # –ü–æ–∫–∞ —Å—Ç–æ–ª–±–µ—Ü B –≤ —Å—Ç—Ä–æ–∫–µ next_row –Ω–µ –ø—É—Å—Ç–æ–π
        next_row += 1

    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, —Ç–∞—Ä–∏—Ñ–µ –∏ –¥–∞—Ç–µ –æ–ø–ª–∞—Ç—ã –≤ —Ñ–∞–π–ª Excel
    sheet[f'A{next_row}'] = username
    sheet[f'B{next_row}'] = user_id
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–∞—Ä–∏—Ñ–∞ –≤ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞
    tariff_names = {
        "tariff_A": "–¢–∞—Ä–∏—Ñ 1 –º–µ—Å—è—Ü",
        "tariff_B": "–¢–∞—Ä–∏—Ñ 3 –º–µ—Å—è—Ü–∞",
        "tariff_C": "–¢–∞—Ä–∏—Ñ 6 –º–µ—Å—è—Ü–µ–≤",
        "tariff_D": "–¢–∞—Ä–∏—Ñ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π"
    }
    sheet[f'C{next_row}'] = tariff_names.get(tariff, "Unknown Tariff")
    sheet[f'D{next_row}'] = datetime.now().strftime('%Y-%m-%d %H:%M:%S')

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–µ Excel
    wb.save(excel_file_path)

    # –°–æ–∑–¥–∞–µ–º –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫—É "–ò–ù–°–¢–†–£–ö–¶–ò–Ø" —Å –Ω—É–∂–Ω–æ–π —Å—Å—ã–ª–∫–æ–π
    inline_keyboard = InlineKeyboardMarkup()
    inline_keyboard.add(InlineKeyboardButton("–ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è", url="https://teletype.in/@ghostguardvpn/xv_6scteadf"))

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π "–ò–ù–°–¢–†–£–ö–¶–ò–Ø"
    bot.send_message(user_id,
                     "–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É! \n–ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å–≤–æ–π —Ç–æ–∫–µ–Ω –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ú–æ–∏ –∑–∞–∫–∞–∑—ã\n–î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –≤–∞—à–µ–º—É —Å–µ—Ä–≤–µ—Ä—É –ø–æ —Ç–æ–∫–µ–Ω—É –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ",
                     reply_markup=inline_keyboard)



# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã "–ü–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"
@bot.message_handler(func=lambda message: message.text == '–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç')
def send_useful_info(message):
    # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏
    inline_keyboard = InlineKeyboardMarkup()
    # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏
    inline_keyboard.row(InlineKeyboardButton("–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã", url="https://teletype.in/@ghostguardvpn/FxpP9tTdJB8"))
    inline_keyboard.row(
        InlineKeyboardButton("–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ OUTLINE", url="https://teletype.in/@ghostguardvpn/xv_6scteadf"))
    inline_keyboard.row(
        InlineKeyboardButton("–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏", url="https://teletype.in/@ghostguardvpn/f1U9AUIksea"))

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
    bot.send_message(message.chat.id, """üîë –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

–ü—Ä–æ—Å—Ç–æ –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –≤–∞–º –ø–ª–∞–Ω, –ø—Ä–∏–æ–±—Ä–µ—Ç–∏—Ç–µ –∫–ª—é—á —á–µ—Ä–µ–∑ –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞ –∏ –Ω–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –∏ –±—ã—Å—Ç—Ä—ã–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º –ø–æ–¥ –≤–∞—à–∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏.

–í—ã–±–∏—Ä–∞–π—Ç–µ –Ω–∞—à VPN-—Å–µ—Ä–≤–∏—Å –¥–ª—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∫ –≤–∞—à–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤ —Å–µ—Ç–∏!

üöÄ –ü–æ—á–µ–º—É –≤—ã–±–∏—Ä–∞—é—Ç –Ω–∞—Å?

–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥: –ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–∞—à–∏–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è–º–∏, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ: –ù–∞—à VPN-—Å–µ—Ä–≤–∏—Å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∑–∞—â–∏—Ç—É –≤–∞—à–µ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–∞—à–µ–π –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Å–µ—Ç–∏.

–í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å: –ù–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –∏ –∑–∞–¥–µ—Ä–∂–µ–∫.

–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏ —É–¥–æ–±—Å—Ç–≤–æ: –ü—Ä–∏–æ–±—Ä–µ—Ç–∞–π—Ç–µ –∫–ª—é—á–∏ –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ —Å–µ—Ä–≤–µ—Ä –ø—Ä—è–º–æ —á–µ—Ä–µ–∑ –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞, —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ —É—Å–∏–ª–∏—è–º–∏ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º.


–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º - –Ω–∞–ø–∏—à–∏—Ç–µ –≤ –ü–æ–¥–¥–µ—Ä–∂–∫—É.

–ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ –æ —Ä–∞–±–æ—Ç–µ –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –º–æ–∂–µ—Ç–µ —É–∑–Ω–∞—Ç—å –∏–∑ –∫–æ–º–∞–Ω–¥ –Ω–∏–∂–µ:""", reply_markup=inline_keyboard)


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã "–ú–æ–∏ –∑–∞–∫–∞–∑—ã"
@bot.message_handler(func=lambda message: message.text == '–ú–æ–π VPN')
def my_orders(message):
    # –ü–æ–ª—É—á–∞–µ–º id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user_id = message.from_user.id

    # –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º Excel
    excel_file_paths = ['TELEGA.xlsx', 'users.xlsx']

    # –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user_orders = []

    # –ò—Ç–µ—Ä–∏—Ä—É–µ–º –ø–æ –∫–∞–∂–¥–æ–º—É —Ñ–∞–π–ª—É Excel
    for excel_file_path in excel_file_paths:
        try:
            # –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª Excel
            wb = openpyxl.load_workbook(excel_file_path)
            sheet = wb.active

            # –ò—â–µ–º –≤—Å–µ –∑–∞–∫–∞–∑—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            for row in sheet.iter_rows(min_row=1, max_row=sheet.max_row, min_col=1, max_col=7):
                if str(row[1].value) == str(user_id):
                    user_orders.append({
                        "–¢–∞—Ä–∏—Ñ": row[2].value,
                        "–î–∞—Ç–∞ –æ–ø–ª–∞—Ç—ã": row[3].value,  # –ù–µ –≤—ã–∑—ã–≤–∞–µ–º strftime() –∑–¥–µ—Å—å
                        "–¢–æ–∫–µ–Ω": row[6].value  # –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ G
                    })
        except FileNotFoundError:
            # –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –∏—Ç–µ—Ä–∞—Ü–∏—é
            continue

    # –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –∑–∞–∫–∞–∑—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if user_orders:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—Å–ª–µ–¥–Ω–µ–º –∑–∞–∫–∞–∑–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        latest_order = user_orders[-1]
        tariff = latest_order['–¢–∞—Ä–∏—Ñ']
        payment_date_str = latest_order['–î–∞—Ç–∞ –æ–ø–ª–∞—Ç—ã']
        token = latest_order['–¢–æ–∫–µ–Ω']

        # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –¥–∞—Ç—ã –æ–ø–ª–∞—Ç—ã –≤ –æ–±—ä–µ–∫—Ç datetime
        payment_date = datetime.strptime(payment_date_str, '%Y-%m-%d %H:%M:%S')

        # –í—ã—á–∏—Å–ª—è–µ–º –¥–∞—Ç—É –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è —Ç–∞—Ä–∏—Ñ–∞
        if tariff == "–¢–∞—Ä–∏—Ñ 1 –º–µ—Å—è—Ü":
            end_date = payment_date + timedelta(days=30)
        elif tariff == "–¢–∞—Ä–∏—Ñ 3 –º–µ—Å—è—Ü–∞":
            end_date = payment_date + timedelta(days=90)
        elif tariff == "–¢–∞—Ä–∏—Ñ 6 –º–µ—Å—è—Ü–µ–≤":
            end_date = payment_date + timedelta(days=180)
        elif tariff == "–¢–µ—Å—Ç":
            end_date = payment_date + timedelta(days=5)
        else:
            end_date = payment_date  # –ï—Å–ª–∏ —Ç–∞—Ä–∏—Ñ –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω, –ø—Ä–æ—Å—Ç–æ –≤—ã–≤–æ–¥–∏–º –¥–∞—Ç—É –æ–ø–ª–∞—Ç—ã

        # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∑–∞–∫–∞–∑–µ –∏ –¥–∞—Ç–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è
        order_text = f"–í–∞—à —Ç–∞—Ä–∏—Ñ: {tariff}\n–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ: {end_date.strftime('%Y-%m-%d %H:%M:%S')}\n –í–∞—à —Ç–æ–∫–µ–Ω:"

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∑–∞–∫–∞–∑–µ –∏ –¥–∞—Ç–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è
        bot.send_message(user_id, order_text)

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤—Ç–æ—Ä—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–æ–∫–µ–Ω
        bot.send_message(user_id, f"{token}")
    else:
        bot.send_message(user_id, "–£ –≤–∞—Å –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤.")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã "–ü–æ–¥–¥–µ—Ä–∂–∫–∞"
@bot.message_handler(func=lambda message: message.text == '–ü–æ–¥–¥–µ—Ä–∂–∫–∞')
def support(message):
    # –°–æ–∑–¥–∞–µ–º –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫—É –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –¥–∏–∞–ª–æ–≥—É —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º @gorponk
    inline_keyboard = InlineKeyboardMarkup()
    inline_keyboard.add(InlineKeyboardButton("–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É", url="https://t.me/ghostguardvpn"))

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π "–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É"
    bot.send_message(message.chat.id,
                     "ü§ù –ù–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ —Å 10:00 –¥–æ 22:00 –ø–æ –ú–°–ö  –∫–∞–∂–¥—ã–π –¥–µ–Ω—å. –ü–∏—à–∏—Ç–µ –Ω–∞–º –ø–æ –ª—é–±—ã–º –≤–æ–ø—Ä–æ—Å–∞–º, –∏ –º—ã –±—ã—Å—Ç—Ä–æ –Ω–∞–π–¥–µ–º —Ä–µ—à–µ–Ω–∏–µ, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –≤–∞–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∫–æ–º—Ñ–æ—Ä—Ç –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.",
                     reply_markup=inline_keyboard)


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã "–û –Ω–∞—Å"
@bot.message_handler(func=lambda message: message.text == '–û –Ω–∞—Å')
def about_us(message):
    # –¢–µ–∫—Å—Ç –æ –≤–∞—à–µ–π –∫–æ–º–ø–∞–Ω–∏–∏
    about_text = """üîí –ù–∞—à —Å–µ—Ä–≤–∏—Å VPN –±–∞–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ OUTLINE, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –Ω–∞–¥–µ–∂–Ω–æ–µ –∏ –ø—Ä–æ—Å—Ç–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∑–∞—â–∏—â–µ–Ω–Ω–æ–π —Å–µ—Ç–∏.

üöÄ –°–∫–æ—Ä–æ—Å—Ç—å –∏ –±–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ ‚Äì —ç—Ç–æ –Ω–∞—à —Å—Ç–∞–Ω–¥–∞—Ä—Ç. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–µ—Ä–≤–µ—Ä—ã —Å –∫–∞–Ω–∞–ª–∞–º–∏ –¥–æ 10 –ì–±–∏—Ç, —á—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–ª–∞–≤–Ω—É—é —Ä–∞–±–æ—Ç—É –¥–∞–∂–µ –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ YouTube –≤ 4–ö –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –∑–∞–¥–µ—Ä–∂–µ–∫ –Ω–∞ –ª—é–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö.

üï∂Ô∏è –ú—ã —Ü–µ–Ω–∏–º –≤–∞—à—É –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å. –ù–∏–∫–∞–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ –≤–∞—Å –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è ‚Äì —ç—Ç–æ –Ω–∞—à –ø—Ä–∏–Ω—Ü–∏–ø. –ú—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –ø–æ–ª–Ω—É—é –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å, –Ω–µ —Ö—Ä–∞–Ω—è –∏—Å—Ç–æ—Ä–∏—é –≤–∞—à–∏—Ö –æ–Ω–ª–∞–π–Ω-–ø–µ—Ä–µ—Ö–æ–¥–æ–≤. –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ —à–∏—Ñ—Ä—É—é—Ç—Å—è –∏ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–∂–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º —Å–µ—Ä–≤–∏—Å–∞.

üîê –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –Ω–∞—à VPN-—Å–µ—Ä–≤–∏—Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–∞—à–µ–π —Å–≤—è–∑–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –∑–∞—â–∏—Ç—ã –æ—Ç —É—Ç–µ—á–µ–∫.

üì± –ú—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –≤—Å–µ –≤–∞—à–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –≤–∫–ª—é—á–∞—è —Ç–µ–ª–µ—Ñ–æ–Ω—ã –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã. –ù–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤–∞ –ø–æ–º–æ—á—å –≤ –ª—é–±—ã—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º VPN. 

üìü–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –ª—é–±–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–∞ –ª—é–±–æ–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ, –∞ —Ç–∞–∫ –∂–µ –Ω–∞—à VPN —Å–æ–≤–º–µ—Å—Ç–∏–º —Å–æ –≤—Å–µ–º–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏"""
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –æ –∫–æ–º–ø–∞–Ω–∏–∏
    bot.send_message(chat_id=message.chat.id, text=about_text)

# –ü–û–ü–†–û–ë–û–í–ê–¢–¨ –ë–ï–°–ü–õ–ê–¢–ù–û

# –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ñ–∞–π–ª Excel
def save_to_excel(username, user_id, action):
    try:
        wb = openpyxl.load_workbook('users.xlsx')
        sheet = wb.active
    except FileNotFoundError:
        wb = openpyxl.Workbook()
        sheet = wb.active
        sheet.append(["Username", "User ID", "Action", "Date"])

    # –ò—â–µ–º –ø–µ—Ä–≤—É—é –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É –≤ —Å—Ç–æ–ª–±—Ü–µ A
    next_row = 1
    while sheet.cell(row=next_row, column=1).value is not None:
        next_row += 1

    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –Ω–∞–π–¥–µ–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É
    sheet.cell(row=next_row, column=1).value = username
    sheet.cell(row=next_row, column=2).value = user_id
    sheet.cell(row=next_row, column=3).value = action
    sheet.cell(row=next_row, column=4).value = datetime.now().strftime("%Y-%m-%d %H:%M:%S")

    wb.save('users.xlsx')
    print("–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã:", username, user_id, action)

# –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Ñ–∞–π–ª–∞ Excel
def get_test_token(username):
    try:
        wb = openpyxl.load_workbook('users.xlsx')
        sheet = wb.active

        for row in sheet.iter_rows(values_only=True):
            if row[0] == username:
                return row[6]  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ 6 —Å—Ç–æ–ª–±—Ü–∞ (–ø–æ—Å–ª–µ 5 —Å—Ç–æ–ª–±—Ü–∞)
    except FileNotFoundError:
        pass

    return None

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã "–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ"
@bot.message_handler(func=lambda message: message.text == '–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ')
def try_for_free(message):
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ñ–∞–π–ª–µ
    test_token = get_test_token(message.chat.username)

    if test_token:
        # –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∂–µ –µ—Å—Ç—å, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –æ–Ω —É–∂–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –±–µ—Å–ø–ª–∞—Ç–Ω—ã–º –ø–µ—Ä–∏–æ–¥–æ–º
        bot.send_message(message.chat.id, "–ò–∑–≤–∏–Ω–∏—Ç–µ, –≤—ã —É–∂–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–º –ø–µ—Ä–∏–æ–¥–æ–º.")
    else:
        # –ü–æ–ª—É—á–∞–µ–º –¥–∞—Ç—É –Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –∏ –ø—Ä–∏–±–∞–≤–ª—è–µ–º 5 –¥–Ω–µ–π
        start_date = datetime.now()
        end_date = start_date + timedelta(days=5)

        # –°–æ–∑–¥–∞–µ–º –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫—É –¥–ª—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
        markup = types.InlineKeyboardMarkup()
        instruction_button = types.InlineKeyboardButton("–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é", url="https://teletype.in/@ghostguardvpn/xv_6scteadf")
        markup.add(instruction_button)

        # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –¥–æ—Å—Ç—É–ø–µ –∏ –¥–∞—Ç–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è
        message_text = "–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –¥–æ—Å—Ç—É–ø!\n\n–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ: {}".format(end_date.strftime("%Y-%m-%d"))
        message_text += "\n\n–í–∞—à —Ç–æ–∫–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ —Å–Ω–∏–∑—É. –î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:"

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º, –∫–Ω–æ–ø–∫–æ–π –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π
        bot.send_message(message.chat.id, message_text, reply_markup=markup)

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ñ–∞–π–ª Excel
        save_to_excel(message.chat.username, message.chat.id, "–¢–µ—Å—Ç")

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤—Ç–æ—Ä—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–æ–∫–µ–Ω
        test_token_message = "{}".format(get_test_token(message.chat.username))
        bot.send_message(message.chat.id, test_token_message)


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å –º–µ–Ω—é
def create_menu_keyboard():
    keyboard = ReplyKeyboardMarkup(row_width=2, resize_keyboard=True)  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ row_width=2
    buttons = ["–û –Ω–∞—Å", "–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç", "–ö–∞–∫ –æ–ø–ª–∞—Ç–∏—Ç—å", "–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ", "–ú–æ–π VPN", "–ü–æ–¥–¥–µ—Ä–∂–∫–∞"]
    for i in range(0, len(buttons), 2):  # –ò—Ç–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –∫–Ω–æ–ø–∫–∞–º –ø–æ–ø–∞—Ä–Ω–æ
        button_row = buttons[i:i + 2]  # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–≤—É—Ö –∫–Ω–æ–ø–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä—è–¥–∞
        keyboard.add(*[KeyboardButton(text=button) for button in button_row])
    return keyboard

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
bot.polling()
